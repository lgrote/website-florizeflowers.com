---
import { getCollection } from 'astro:content';
import ImageCard from '../ui/ImageCard.astro';

export interface Props {
  className?: string;
}

const { className = '' } = Astro.props;

// Get updates from collection and sort by order
const updatesCollection = await getCollection('updates');
const updates = updatesCollection
  .sort((a, b) => (a.data.order || 999) - (b.data.order || 999))
  .map(update => ({
    image: update.data.image,
    imageAlt: update.data.imageAlt,
    title: update.data.title,
    description: update.data.description
  }));
---

<section class={`section-padding bg-cream-white ${className}`} aria-labelledby="updates-heading">
  <div class="container">
    <div class="max-w-6xl mx-auto text-center">
      <h2 id="updates-heading" class="text-3xl font-bold text-florize-green mb-6">
        Latest Service Updates & Seasonal Recommendations
      </h2>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mt-8">
        {updates.map((update) => (
          <ImageCard
            image={update.image}
            imageAlt={update.imageAlt}
            title={update.title}
            description={update.description}
          />
        ))}
      </div>

      <p class="mt-8 text-lg text-gray-700 max-w-4xl mx-auto">
        Stay updated with our latest testing results, seasonal recommendations, and new service launches by visiting our comparison pages regularly.
      </p>
    </div>
  </div>
</section>
