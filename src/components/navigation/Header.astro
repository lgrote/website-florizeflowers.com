---
import { getCollection } from 'astro:content';
import MobileMenu from './MobileMenu.astro';
import DropdownMenu from './DropdownMenu.astro';

// Auto-generate service dropdown items from services collection
const allServices = await getCollection('services');
const serviceItems = [
  ...allServices
    .sort((a, b) => a.data.base.name.localeCompare(b.data.base.name))
    .map(service => ({
      label: `${service.data.base.name} Review`,
      href: `/services/${service.data.base.id}`
    })),
  { divider: true },
  { label: 'All Service Reviews', href: '/services' },
];

// Auto-generate occasion dropdown items from occasions collection
const allOccasions = await getCollection('occasions');
const occasionItems = [
  ...allOccasions
    .sort((a, b) => a.data.base.name.localeCompare(b.data.base.name))
    .map(occasion => ({
      label: `${occasion.data.base.name} Flowers`,
      href: `/occasions/${occasion.data.base.id}`
    })),
  { divider: true },
  { label: 'All Occasion Guides', href: '/occasions' },
];
---

<header class="bg-florize-green text-white py-4 shadow-md">
  <nav class="container mx-auto px-4">
    <div class="flex items-center justify-between">
      <a href="/" class="flex items-center">
        <img
          src="/images/florizeflowers-logo-white.svg"
          alt="Florize Flowers - UK Flower Delivery Reviews"
          class="h-10 w-auto"
        />
      </a>

      <!-- Desktop Navigation -->
      <ul class="hidden md:flex gap-6 items-center">
        <li><a href="/" class="hover:text-bloom-pink transition-colors">Home</a></li>
        <li>
          <DropdownMenu
            label="Services"
            href="/services"
            items={serviceItems}
          />
        </li>
        <li>
          <DropdownMenu
            label="Occasions"
            href="/occasions"
            items={occasionItems}
          />
        </li>
        <li><a href="/guides" class="hover:text-bloom-pink transition-colors">Guides</a></li>
        <li><a href="/about" class="hover:text-bloom-pink transition-colors">About</a></li>
        <li><a href="/contact" class="hover:text-bloom-pink transition-colors">Contact</a></li>
      </ul>

      <!-- Mobile Navigation -->
      <MobileMenu />
    </div>
  </nav>
</header>
