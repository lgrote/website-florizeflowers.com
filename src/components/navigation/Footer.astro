---
import { getCollection, getEntry } from 'astro:content';

// Auto-generate top services for footer (top 3)
const allServices = await getCollection('services');
const topServices = allServices
  .sort((a, b) => (b.data.base.rating || 0) - (a.data.base.rating || 0))
  .slice(0, 3);

// Auto-generate top occasions for footer (top 3)
const allOccasions = await getCollection('occasions');
const topOccasions = allOccasions
  .sort((a, b) => a.data.base.name.localeCompare(b.data.base.name))
  .slice(0, 3);

// Get footer content
const footerData = await getEntry('homepage-sections', 'footer');
---

<footer class="bg-charcoal text-white py-12 mt-16">
  <div class="container mx-auto px-4">
    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
      <div>
        <h4 class="text-xl font-bold mb-4">Service Reviews</h4>
        <ul class="space-y-2">
          {topServices.map(service => (
            <li>
              <a href={`/services/${service.data.base.id}`} class="hover:text-bloom-pink transition-colors">
                {service.data.base.name} Review
              </a>
            </li>
          ))}
          <li><a href="/services" class="hover:text-bloom-pink transition-colors">All Service Reviews</a></li>
        </ul>
      </div>
      <div>
        <h4 class="text-xl font-bold mb-4">Occasion Guides</h4>
        <ul class="space-y-2">
          {topOccasions.map(occasion => (
            <li>
              <a href={`/occasions/${occasion.data.base.id}`} class="hover:text-bloom-pink transition-colors">
                {occasion.data.base.name} Flowers
              </a>
            </li>
          ))}
          <li><a href="/occasions" class="hover:text-bloom-pink transition-colors">All Occasion Guides</a></li>
        </ul>
      </div>
      <div>
        <h4 class="text-xl font-bold mb-4">Company Information</h4>
        <ul class="space-y-2">
          <li><a href="/about" class="hover:text-bloom-pink transition-colors">About Florize</a></li>
          <li><a href="/contact" class="hover:text-bloom-pink transition-colors">Contact Us</a></li>
          <li><a href="/privacy-policy" class="hover:text-bloom-pink transition-colors">Privacy Policy</a></li>
          <li><a href="/terms-of-use" class="hover:text-bloom-pink transition-colors">Terms of Use</a></li>
          <li><a href="/affiliate-disclosure" class="hover:text-bloom-pink transition-colors">Affiliate Disclosure</a></li>
          <li><a href="/sitemap-page" class="hover:text-bloom-pink transition-colors">Sitemap</a></li>
        </ul>
      </div>
    </div>
    <div class="border-t border-gray-700 mt-8 pt-8 text-center">
      <div class="mb-4">
        <img
          src="/images/florizeflowers-logo-white.svg"
          alt="Florize Flowers"
          class="h-8 w-auto mx-auto"
        />
      </div>
      <p>&copy; 2025 Florize Flowers. All rights reserved. | {footerData.data.description}</p>
    </div>
  </div>
</footer>
